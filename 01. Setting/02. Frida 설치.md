## 2. 🛠️ Frida 설치 & 기본 문법
- [2.1 📦 아나콘다 & 프리다 환경 설정](#21-아나콘다--프리다-환경-설정)
- [2.2 ✏️ Frida 기본 문법](#22-frida-기본-문법)


### 2.1 아나콘다 & 프리다 환경 설정
>PC 설정
>1. anaconda 설치, 설치 이상 없을 시 CMD에서 `conda --version` 정상 출력
>2. python 3 버전 설치, 설치 이상 없을 시 CMD에서 `python --version` 으로 3 버전대 정상 출력
>3. 2에서 확인한 python 버전에 맞게 ios_py3  이름의 가상환경 생성 : `conda create -n ios_py3 python=3.12 -y`
>4. ios_py3 이름의 가상 환경 진입 : `conda activate ios_py3` 
>5. 진입한 가상 환경에 Frida 설치 : `pip install frida-tools`
>6. Frida 정상 설치 확인 : `frida --version` 

>iOS 단말 설정
> 1. https://github.com/frida/frida/releases 에 들어가서 확장자 `deb`인 frida server 파일을 설치한다. 주의할 점은 PC와 동일한 버전을 설치해야 한다.
> 2. WinSCP 나 3utools을 통해 설치한 deb 파일을 iOS 기기의 /var/tmp/ 이동
> 3. iOS SSH 접속 후 deb 설치 : `dpkg -i /var/tmp/frida-server.deb` 
> 4. 3번에서 만약 의존성 에러가 발생한다면 : `apt-get -f install` 
> 5. 실행 권한 부여 : `chmod +x /usr/sbin/frida-server`
> 6. 백그라운드로 프리다 서버 실행 : `frida-server &`

> PC의 프리다와 iOS 프리다 통신 연결 확인
> 1. PC 에서 Frida를 ios_py3 이름의 아나콘다 가상환경에 설치하였으므로 가상환경 진입 : `conda activate ios_py3` 
> 2. `frida-ps U` 명령어 사용 시 iOS 에서 실행 중인 프로세스 출력 시 정상

### 2.2 Frida 기본 문법

ObjC.available
- 현재 프로세스에 Objective-C 런타임이 로드되었는지 여부를 지정하는 Boolean(True, False)
- 해당 앱에 Frida가 적용되는지 여부를 파악하는 용도, 따라서 무조건 사용

ObjC.classes
- 현재 등록된 클래스에 대한 ObjC.object 자바스크립트 바인딩에 대한 오브젝트 맵핑 클래스 이름
- 앱 사용 시 로드된 프로세스(Class) 조회 용도

Interceptor.attach(target, callbacks[, data])
- target : 함수에 대한 호출을 가로챔 (호출을 가로채고자 하는 함수의 주소를 지정하는 NativePointer) : 후킹
- callbacks 인수는 하나 이상을 포함하는 오브젝트(객체)
  - onEnter: function(args) : NativePointer 객체의 배열로 인수를 읽거나 쓰는 데 사용할 수 있는 하나의 인수 args가 제공된 callback 함수 
  - onLeave: function(retval)
    - : 원래 return 값을 포함하는 NativePointer에서 파생 객체인 인수 retval이 제공된 callback 함수
    - : retval.replace(1337)를 호출하여 return 값을 정수 1337 으로 바꾸거나,
    - : retval.replace(ptr(0x1234))를 ptr로 감싸면 포인터로 변경 가능
- Module.findBaseAddress(name)
- Module.getBaseAddress(name) 
  - : name 모듈의 base 주소를 반환
  - : 모듈을 찾을 수 없는 경우
    - : find-prefixed 함수는 null을 반환
    - : get-prefixed 함수는 예외를 발생
- NativePointer (new NativePointer(s))
  - : 메모리 주소를 10 진수 또는 16진수로 표현하는 문자열 s에서 새로운 NativePointer를 생성, 포인터 생성 용도 
  - : 간결하게 ptr(s) 로 사용 가능

$methods
- 주어진 객체의 클래스와 부모 클래스에 의해 노출된 기본 메소드 이름을 포함하는 배열

$ownMethods
- $methods 에서 부모 클래스의 메소드만 제외

context
- ia32/x64/arm에 대해 각각 EIP/RIP/PC 및 ESP/RSP/SP를 지정하는 NativePointer 객체인 pc 및 sp 키가 있는 객체
- 다른 프로세스별 키(예: eax, rax, r0, x0 등)도 사용 가능
- 이 키에 할당하여 레지스터 값을 업데이트 가능

그 외 추가 문법은 [Frida url](https://frida.re/docs/javascript-api/)에서 확인

---

